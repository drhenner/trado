- content_for :title, 'Select a shipping method'
.container
  .row
    / ==========
    / = Main content =
    / ==========
    %section.span12
      .checkout-container
        .row
          .span10.offset1
            / ==========
            / = Header =
            / ==========
            %header
              .row
                .span6.offset2
                  .center-align
                    %h1
                      %span.light Shipping
                      address
                .span2
            / ==========
            / = Steps =
            / ==========
            .checkout-steps
              .clearfix
                .step.done
                  .step-badge
                    %i.fa.fa-check
                  = link_to 'Review cart', wizard_path(:review)
                .step.done
                  .step-badge
                    %i.fa.fa-check
                  = link_to 'Billing details', wizard_path(:billing)
                .step.active
                  .step-badge 3
                  Shipping address
                .step
                  .step-badge 4
                  Payment method
                .step
                  .step-badge 5
                  Confirm & pay
            / /steps
            / ==========
            / = Shipping addr form =
            / ==========
            = form_for @delivery_address, :url => wizard_path, :html => { method: :patch, :class => 'form-horizontal form-checkout delivery_address' } do |f|
              .control-group
                %label.control-label
                  Same as billing address?
                .controls
                  %input.use-billing-address{type: 'checkbox'}
              .control-group
                = f.label :first_name, :class => 'control-label' do
                  First name
                  %span.red-clr.bold *
                .controls
                  = f.text_field :first_name, :class => 'span4 use-billing', :id => 'delivery_first_name'
                  %div= @order.billing_address.first_name
                  = errors_for @delivery_address, :first_name
              .control-group
                = f.label :last_name, :class => 'control-label' do
                  Last name
                  %span.red-clr.bold *
                .controls
                  = f.text_field :last_name, :class => 'span4 use-billing', :id => 'delivery_last_name'
                  %div= @order.billing_address.last_name
                  = errors_for @delivery_address, :last_name
              = fields_for @order do |ff|
                .control-group
                  = ff.label :email, :class => 'control-label' do
                    Email
                    %span.red-clr.bold *
                  .controls
                    = ff.text_field :email, :class => 'span4', :id => 'email'
                    = errors_for @order, :email
              .control-group
                = f.label :telephone, :class => 'control-label' do
                  Telephone
                .controls
                  = f.text_field :telephone, :class => 'span4 use-billing', :id => 'delivery_telephone'
                  %div= @order.billing_address.telephone
              .control-group
                = f.label :company, :class => 'control-label' do
                  Company
                .controls
                  = f.text_field :company, :class => 'span4 use-billing', :id => 'delivery_company'
                  %div= @order.billing_address.company
              .control-group
                = f.label :address, :class => 'control-label' do
                  Street address
                  %span.red-clr.bold *
                .controls
                  = f.text_field :address, :class => 'span4 use-billing', :id => 'delivery_address'
                  %div= @order.billing_address.address
                  = errors_for @delivery_address, :address
              .control-group
                = f.label :city, :class => 'control-label' do
                  City
                  %span.red-clr.bold *
                .controls
                  = f.text_field :city, :class => 'span4 use-billing', :id => 'delivery_city'
                  %div= @order.billing_address.city
                  = errors_for @delivery_address, :city
              .control-group
                = f.label :postcode, :class => 'control-label' do
                  Postcode
                  %span.red-clr.bold *
                .controls
                  = f.text_field :postcode, :class => 'span4 use-billing', :id => 'delivery_postcode'
                  %div= @order.billing_address.postcode
                  = errors_for @delivery_address, :postcode
              .control-group
                = f.label :county, :class => 'control-label' do
                  County
                .controls
                  = f.text_field :county, :class => 'span4 use-billing', :id => 'delivery_county'
                  %div= @order.billing_address.county
              .control-group
                = f.label :country, :class => 'control-label' do
                  Country
                  %span.red-clr.bold *
                .controls.update-delivery-service-price
                  = f.select(:country, options_for_select(Country.all.map { |country| [country.name, country.name] }, :selected => @delivery_address.country), { include_blank: 'Please select...'})
                  = errors_for @delivery_address, :country
              .delivery-service-prices
                .control-group
                  = f.label :delivery_id, :class => 'control-label' do
                    Shipping options
                    %span.red-clr.bold *
                  .controls
                    - unless @order.delivery_id.nil?
                      = render partial: theme_presenter.page_template_path("orders/delivery_service_prices/fields"), format: [:html], :locals => { delivery_service_prices: @delivery_service_prices, delivery_id: @order.delivery_id }
                    - else
                      %p.delivery_service_price_notice Select a country to view the available delivery services.
              .control-group
                .controls
                  = errors_for @order, :delivery_id
              %hr/
              %p.right-align
                = f.submit 'Continue', :class => 'btn btn-primary higher bold'
    / /main content
/ /container