<% content_for :header_1, Store::settings.name %>
<% content_for :header_2, "Order ##{@order.id} unsuccessful" %>

Hello <%= @order.delivery_address.full_name %>,

Unfortunately your order was unsuccessful. 

<% unless @order.transactions.last.status_reason.nil? %>
Your order was unsuccessful for the following reason(s): 
<%= @order.transactions.last.status_reason %>
<% end %>

Your delivery option
---------------------
<%= @order.delivery.full_name %>

Your delivery address
---------------------
<%= @order.delivery_address.full_name %>
<%= @order.delivery_address.address %>
<%= @order.delivery_address.city %>
<%= @order.delivery_address.postcode %>
<%= @order.delivery_address.country %>
<%= @order.delivery_address.telephone %>

Payment method
---------------------
<%= "PayPal" unless @order.express_token.nil? %>

Your billing address
---------------------
<%= @order.billing_address.full_name %>
<%= @order.billing_address.address %>
<%= @order.billing_address.city %>
<%= @order.billing_address.postcode %>
<%= @order.billing_address.country %>
<%= @order.billing_address.telephone %>

Order details
---------------------
Placed on <%= @order.updated_at.strftime("#{@order.updated_at.day.ordinalize} %b %Y") %>

<% @order.order_items.each do |item| %>
    <%= item.sku.product.name %> | <%= Store::Price.new(price: item.price, tax_type: 'net').single %> | <%= item.quantity %> | <%= Store::Price.new(price: item.total_price, tax_type: 'net').single %>
<% end %>

Subtotal: <%= Store::Price.new(price: @order.net_amount, tax_type: 'net').single %>
Delivery: <%= Store::Price.new(price: @order.delivery.price, tax_type: 'net').single %>
<%= Store::settings.tax_name %>: <%= Store::Price.new(price: @order.tax_amount, tax_type: 'net').single %>
Total: <%= Store::Price.new(price: @order.gross_amount, tax_type: 'net').single %>

If you would like assistance with your order, please don't hesitate to contact us at support@gimsonrobotics.co.uk, quoting your order number.

Regards
<%= Store::settings.name %> team